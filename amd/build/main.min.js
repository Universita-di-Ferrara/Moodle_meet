define("mod_gmeet/main",["exports","core_form/modalform","core/modal_factory","core/modal_events","core/str","./ajax_call","core/toast"],(function(_exports,_modalform,_modal_factory,_modal_events,_str,_ajax_call,_toast){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * TODO describe module main
   *
   * @module     mod_gmeet/main
   * @copyright  2024 YOUR NAME <your@email.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events);const Selectors_actions={syncRecordings:'[data-action="mod_gmeet/sync_recordings"]',editRecording:"[data-role=editfield][data-id]",deleteRecording:"[data-role=deletefield][data-id]"},registerEventListeners=deletemodal=>{document.addEventListener("click",(e=>{const editingRecordingelement=e.target.closest(Selectors_actions.editRecording),syncRecordingelement=e.target.closest(Selectors_actions.syncRecordings),deleteRecordingelement=e.target.closest(Selectors_actions.deleteRecording);if(editingRecordingelement){e.preventDefault();const recordingid=editingRecordingelement.getAttribute("data-id"),courseid=editingRecordingelement.getAttribute("course-id");(async(id,courseid)=>await(0,_ajax_call.getRecording)(id,courseid))(recordingid,courseid).then((values=>{const modalForm=new _modalform.default({formClass:"mod_gmeet\\recording_form",args:{id:recordingid,recordingname:values.name,recordingdescription:values.description,courseid:courseid},modalConfig:{title:(0,_str.get_string)("editingfield","mod_gmeet",editingRecordingelement.getAttribute("data-name"))},returnFocus:editingRecordingelement});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(e=>{const formdata=e.detail;(0,_toast.add)((0,_str.get_string)("edittoast","mod_gmeet")),(async recording=>{(await(0,_ajax_call.updateRecording)(recording)).responsecode&&window.location.reload(!0)})(formdata)})),modalForm.show()}))}if(syncRecordingelement){e.preventDefault(),(0,_toast.add)((0,_str.get_string)("synctoast","mod_gmeet"));document.getElementById("syncForm").submit(),syncRecordingelement.disabled=!0}if(deleteRecordingelement){const recordingid=deleteRecordingelement.getAttribute("data-id"),courseid=deleteRecordingelement.getAttribute("course-id");e.preventDefault(),deletemodal.show(),deletemodal.getRoot().on(_modal_events.default.save,(()=>{(0,_toast.add)((0,_str.get_string)("deletetoast","mod_gmeet"),{type:"danger"}),(async(id,courseid)=>{(await(0,_ajax_call.deleteRecording)(id,courseid)).responsecode&&window.location.reload(!0)})(recordingid,courseid)}))}}))};_exports.init=async()=>{const deleteform=await _modal_factory.default.create({type:_modal_factory.default.types.SAVE_CANCEL,title:(0,_str.get_string)("delete_form_title","mod_gmeet"),body:(0,_str.get_string)("delete_form_body","mod_gmeet"),buttons:{save:(0,_str.get_string)("delete_form_button","mod_gmeet")}});registerEventListeners(deleteform)}}));

//# sourceMappingURL=main.min.js.map